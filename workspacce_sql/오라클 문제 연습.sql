/* 250513 */
/* 교재 130,131쪽 문제 */
-- Q1. EMP 테이블을 사용하여 사원 이름(ENAME)이 S로 끝나는 사원 데이터를 모두 출력

-- Q2. EMP 테이블을 사용하여 30번 부서에서 근무하는 사원 중 직책이 SALESMAN인 사원인 사원의 번호, 이름, 직책, 급여, 부서 번호를 출력

/* Q3. EMP 테이블을 사용하여 20번, 30번 부서에서 근무하는 사원 중 급여가 2000 초과인 사원을 다음 두 방식의 select문을 사용하여 
사원 번호, 이름, 직책, 급여, 부서 번호를 출력 */
-- 집합 연산자를 사용하지 않은 방식 

-- 집합 연산자를 사용한 방식

-- Q4. not between A and B 연산자를 쓰지 않고 급여 열이 2000 이상 3000 이하 범위 의외의 값을 가진 데이터만 출력

-- Q5. 사원 이름에 E가 포함되고 30번 부서의 사원 중 급여가 1000~2000 사이가 아닌 사원 이름, 사원 번호, 급여, 부서 번호를 출력

/* Q6. 추가 수당이 없고 상급자가 있고 직책이 MANAGER, CLERK인 사원 중에서 
사원 이름의 두번째 글짜가 L이 아닌 사원의 정보를 출력 */


/* 챗지피티로 논리회로 해석 문제 연습 */
/* 연습 문제 1
조건: 부서 번호(DEPTNO)가 10도 아니고 30도 아닌 직원들을 조회하라.
BETWEEN, IN 사용 금지 */

/* 연습 문제 2
조건: 이름(ENAME)이 'SMITH' 또는 'ALLEN'이 아닌 직원들을 조회하라. 
NOT IN 사용 금지 */

/* 연습 문제 3
조건: 급여(SAL)가 1000 이상 1500 이하 범위를 제외한 즉, 1000 미만 또는 1500 초과인 직원들을 조회하라.
금지 사항: BETWEEN, NOT BETWEEN */

/*  연습 문제 4
조건: 직업(JOB)이 'MANAGER'이거나 부서번호(DEPTNO)가 20인 직원 중에서, 급여(SAL)가 3000 이상인 직원만 조회하라. */

/* 연습 문제 5
조건: 커미션(COMM)이 NULL이 아닌 직원들만 조회하라. */

/* 연습 문제 7
조건: 급여(SAL)가 1000 이상이고 부서번호(DEPTNO)가 20 이하인 직원 중에서,
직업(JOB)이 'CLERK'이거나 'SALESMAN'인 직원만 조회하라. */

/* 연습 문제 8
조건: 직원 이름(ENAME)이 'KING'이 아니고, 직업(JOB)이 'PRESIDENT'인 직원이 아닌 직원들 중에서,
부서번호(DEPTNO)가 10 또는 30인 직원만 조회하라. 단, IN 연산자는 사용하지 마세요. */



/* 250514 */
-- 1. 부서 번호 10번인 사람들을 출력 

-- 2. 부서 번호 10번이 아닌 사람들을 출력

-- 3. 급여가 3000 이상인 사람들을 출력 

-- 4. 급여가 1500~3000 사이(포함)의 사람을 출력 

-- 5. 부서번호 10번인 사람 중(AND) 급여 2000 이상인 사람을 출력

-- 6. 부서 번호 30번 중 1500~3000 사이(미포함)인 사람을 출력 

-- 7. 부서 번호 30번 중 1500~3000 사이(미포함)인 사람을 연봉이 작은 순으로 출력, 연봉이 같은 경우 이름이 빠른 순으로 출력 

-- 8. 부서 번호 20,30번 중 1500~3000 사이(미포함)인 사람을 연봉이 작은 순으로 출력, 연봉이 같은 경우 이름이 빠른 순으로 출력 

-- 9. 부서 번호가 20 또는 30이고 급여가 1500 이상인 직원의 이름과 급여를 급여 오름차순으로 출력하라. 



/* 250515 */
-- Q1. 사원 이름을 총 20자 중 가운데 정렬

-- Q2 : ENAME의 앞 두글자만 출력

-- Q3 : 앞의 두글자만 원본을 출력하고 나머지는 4개의 *로 표시) 

-- Q4. 사원 이름 두 글자만 보이고 나머지는 *로 , 단 원래 이름 만큼 길이 표시 



/* 250516 */
-- 복습 문제: 각 사원의 연봉을 출력

/* 교재 179, 180쪽 문제 */
/* Q1. EMPNO 열에는 EMP 테이블에서 사원 이름이 다섯 글자 이상이며 여섯 글자 미만인 사원 정보를 출력
        MASKING_EMPNO 열에는 사원 번호 앞 두 자리 외 뒷자리를 * 기호로 출력
        MASKING_ENAME 열에는 사원 이름 첫 글자만 보여주고 나머지 글자 수 만큼 * 기호로 출력 */
-- 출력 열: EMPNO, MASKING_EMPNO, ENAME, MASKING_ENAME

        
/* Q2. EMP 테이블에서 사원의 월 평균 근무일 수는 21.5일이다. 하루 근무 시간을 8시간으로 보았을 때 
        사원의 하루 급여(DAY_PAY)와 시급(TIME_PAY)을 계산하여 결과를 출력.
        단, 하루 급여는 소수 셋째 자리에서 버리고, 시급은 소수 둘째 자리에서 반올림하라. */
-- 출력 열: EMPNO, ENAME, SAL, DAY_PAY, TIME_PAY 


/* Q3. EMP 테이블에서 사원은 입사일을 기준으로 3개월이 지난 후 첫 월요일에 정직원이 된다.
    사원이 정직원이 되는 날짜(R_JOB)을 yyyy-mm-dd 형식으로 출력하라.
    단, 추가 수당(COMM)이 없는 사원의 추가수당은 N/A로 출력, */
-- 출력 열: EMPNO, ENAME, HIREDATE, R_JOB, COMM


/* Q4. EMP 테이블의 모든 사원을 대상으로 직속 상관의 사원 번호(MGR)을 다음과 같은 조건을 기준으로
    변환해서 CHG_MGR열에 출력하라.
    조건 : 직속상관의 사원 번호가 없을 때 : 0000
            직속상관의 사원 번호 앞 두 자리가 75일 때 : 5555
            직속상관의 사원 번호 앞 두 자리가 76일 때 : 6666
            직속상관의 사원 번호 앞 두 자리가 77일 때 : 7777
            직속상관의 사원 번호 앞 두 자리가 78일 때 : 8888
            그 외의 직속상관 사원의 번호일 때 : 본래 직속상관의 사원 번호를 그대로 출력 */
-- 출력 열 : EMPNO, ENAME, MGR, CHG_MGR


/* 교재 200쪽 문제 */
/* Q1. EMP 테이블에서 부서 번호, 평균 급여(AVG_SAL), 최고 급여(MAX_EMP), 최저 급여(MIN_SAL), 사원 수(CNT)를 출력
단, 평균 급여를 출력할 때 소수는 제외하고 부서 번호별로 출력 */
-- 출력 : DEPTNO, AVG_SAL, MAX_SAL, MIN_SAL, CNT

/* Q2. 같은 직책(JOB)에 종사하는 사원이 3명 이상인 직책과 인원수를 출력하라 */
-- 출력 : JOB, COUNT(*)

/* Q3. 사원의 입사 연도(HIRE_YEAR)를 기준으로 부서별로 몇 명씩 입사했는지 출력하라 */
-- 출력: HIRE_YEAR, DEPTNO, CNT

/* Q4. 추가 수당(COMM)을 받는 사원 수와 받지 않는 사원 수를 출력하라 */
-- 출력: EXISXT_COMM, CNT
select nvl2(COMM, 'X', 'O') as EXIST_COMM,
        count(*)
from EMP
group by nvl2(COMM, 'X', 'O');



/* 250519 */
/* 교재 되새김 문제(p.226,227) */
/* Q1. 급여(SAL)가 2000을 초과한 사원의 부서 정보, 사원 정보를 출력
(단, SQL-99 이전 방식과 SQL-99 방식을 각각 사용하라)
출력 : DEPTNO, DNAME, EMPNO, ENAME, SAL */
-- SQL-99 이전 방식
select D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
from EMP E, DEPT D
where E.DEPTNO = D.DEPTNO  
        and SAL > 2000
order by D.DEPTNO;

-- SQL-99 방식
select D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
from EMP E join DEPT D on (D.DEPTNO = E.DEPTNO)
where SAL > 2000
order by D.DEPTNO, E.ENAME;

/* Q2. 부서별 평균 급여, 최대 급여, 최소 급여, 사원 수를 출력
(단, SQL-99 이전 방식과 SQL-99 방식을 각각 사용하라) 
출력: DEPTNO, DNAME, AVG_SAL, MAX_SAL, MIN_SAL, CNT */
-- SQL-99 이전 방식

-- SQL-99 방식


/* Q3. 모든 부서 정보와 사원 정보를 다음과 같이 부서 번호, 사원 이름순으로 정렬하여 출력
(단, SQL-99 이전 방식과 SQL-99 방식을 각각 사용하라) 
출력 : DEPTNO, DNAME, EMPNO, ENAME, JOB, SAL */
-- SQL-99 이전 방식

-- SQL-99 방식


/* Q4. 모든 부서 정보, 사원 정보, 급여 등급 정보, 각 사원의 직속상관 정보를 부서 번호, 사원 번호 순서로 정렬하여 출력
(단, SQL-99 이전 방식과 SQL-99 방식을 각각 사용하라) 
출력 : DEPTNO, DNAME, EMPNO, MGR, SAL, DEPTNO_1, LOSAL, HISAL, GRADE, MGR_EMPNO, MGR_ENAME */
-- SQL-99 이전 방식

-- SQL-99 방식



